@import "_three-cols-layout";

.three-cols-layout-base();

// S+ (columns layout)
@media (min-width: @screen-sm-min) {
  .three-cols-layout-handheld();
}

.three-cols-layout-states();
.three-cols-layout-colors(@column-left-bg, @column-center-bg, @column-right-bg);
.three-cols-layout-header();

[cam-widget-header] [ng-transclude] {
  float: right;
  border-right: 1px solid darken(@gray-lighter, 10%);
  > ul > li:hover {
    border-color: transparent;
  }
}

button {
  &.region-toggle {
    height: @column-top-height;
    margin: 0;
    padding: 0;

    > .glyphicon {
      // min-width: 1em;
      &:before {
        content: '\e257';
      }
    }

    &:focus {
      // outline: none;
    }
  }

  &.region-toggle,
  &.maximize,
  &.reset-regions {
    display: none;
  }

  &.maximize,
  &.reset-regions {
    margin: 0 (@grid-gutter-width / 3);
  }
}

.filters-column-close .column-left .region-toggle .glyphicon:before,
.list-column-close .column-center .region-toggle .glyphicon:before ,
.column-right .region-toggle .glyphicon:before{
  content: '\e258';
}
.task-column-close .column-right .region-toggle .glyphicon:before{
  content: '\e257';
}
// prevent "tab navigation focus" glitch
.task-column-close .column-right {
  .cell.top {
    .reset-regions,
    .maximize,
    .task-actions {
      display: none;
    }
  }
  .cell.content {
    display: none;
  }
}



.three-cols-layout {
  .column-left .list-unstyled > .item,
  .column-center .list-unstyled > li {
    .column-list-item();
  }

  .column-left .list-unstyled {
    .first-column-list();
    > .item {
      .first-column-list-item();
    }
  }

  .column-center .list-unstyled {
    .second-column-list();
    > li {
      .second-column-list-item();
    }
  }

  .column-left h4.name {
    overflow: hidden;
    > span {
      display: inline-block;
      width: 14px;
      height: 14px;
      border-radius: 14px;
      // margin-left: -7px;
      background-color: @gray-lighter;
      // border: 2px solid fade(@gray, 50);
    }
  }

  .column-center {
    [cam-widget-search] {
      margin: 0 (@grid-gutter-width * 0.5);
    }

    .dates,
    .actors {
      > li {
        overflow: hidden;
        white-space: nowrap;
        max-width: 100%;
        > span {
          line-height: 20px;
          vertical-align: text-top;
          display: inline-block;
          &:nth-child(1) {
            margin-top: -3px;
          }
          &:nth-child(2) {
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: ~"calc(100% - 16px)";
          }
        }
      }
    }
  }


  .counter,
  .priority {
    display: inline;
    position: absolute;
    top: 0;
    right: 4px;
    font-size: smaller;
  }
}









.column.tasks-list {
  .content {
    padding-top: 0;
  }
  view {
    display: block;
    overflow: visible;
    padding: (@grid-gutter-width * 0.5) 0;
  }
  [cam-widget-search] {
    margin: 0 (@grid-gutter-width * 0.5);
    padding-bottom: 0;
  }

  [cam-tasks] {
    overflow-x: visible;
    overflow-y: auto;
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
  }
}





// S+ (columns layout)
@media (min-width: @screen-sm-min) {
  .filters-column-close {
    .task-filters {
      .cell.content {
        opacity: 0;
      }
    }
  }


  .list-column-close {
    .tasks-list {
      .cell.content {
        opacity: 0;
      }
    }
  }

  .task-column-close {
    .task-details {
      .cell.content {
        opacity: 0;
      }
    }
  }



  .task-column-close,
  .filters-column-close.list-column-close {
    .maximize {
      display: none;
    }
    .reset-regions {
      display: block;
    }
  }

  .task-column-close {
    [cam-tasklist-variables] .variables-list {
      max-height: 20000px;
      .shutter {
        display: none
      }

      .col-lg-6 {
        width: 33%;
      }

      .variable-item {
        > span {
          width: 50%;
        }

        > .col-xs-4 {
          text-align: right;
        }
      }
    }
  }



  .task-filters,
  .tasks-list {
    > .cell.top > button {
      margin-right: (3 - (@grid-gutter-width / 2));
    }
  }


  .tasks-list {
    > .cell.top {
      > div {
        width: 100%;
        margin-left: 0;
        margin-right: -20px;
        padding: 0 20px 0 0;
      }
    }

    [cam-widget-search] {
      position: relative;
      z-index: 15;
      padding-bottom: (@grid-gutter-width / 2);
      overflow: visible;
    }
  }


  .task-details {
    > .cell.top {
      > button {
        float: left;
        &:first-child {
          margin-left: (3 - (@grid-gutter-width / 2));
        }
      }

      > .task-actions {
        float: right;
        text-align: right;
      }
    }
  }
}


// S
@media (min-width: @screen-sm-min) and (max-width: @screen-sm-max) {
  .three-cols-layout(180px, 300px);
  .three-cols-layout-states(180px, 300px);
}


// M
@media (min-width: @screen-md-min) and (max-width: @screen-md-max) {
  .three-cols-layout(200px, 320px);
  .three-cols-layout-states(200px, 320px);

  .filters-column-close.task-column-close .variables-list .col-lg-6 {
    width: 25%;
  }
}


// L
@media (min-width: @screen-lg-min) {
  .three-cols-layout(220px, 360px);
  .three-cols-layout-states(220px, 360px);

  .filters-column-close.task-column-close .variables-list .col-lg-6 {
    width: 20%;
  }
}
